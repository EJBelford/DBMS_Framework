BEGIN

    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '-1', 1, 'Select one...'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '0', 2, 'FROM PURGED MDR'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '1', 3, 'FROM PURGED MDR'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '2', 4, 'OTHER:  STOCK FUND SECONDARY ITEMS.  THE MAINTENANCE REPAIR AND RECOVERABILITY CODES FOR THE ITEMS SHOULD BE OTHER THAN D'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '3', 5, 'OTHER:  OMA SECONDARY ITEMS.  THE NICP/SICC IS RESPONSIBLE FOR INPUTTING THE BUDGETARY REQUIREMENTS. THE ITEM WILL BE PROCURED WITH OMA FUNDS BY THE NICP/SICC AND WILL BE "FREE ISSUED" TO ARMY CUSTOMERS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '4', 6, 'FROM PURGED MDR'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '5', 7, 'OTHER ITEMS:  OMA MAJOR END ITEMS. THE NICP/SICC IS RESPONSIBLE FOR INPUTTING THE BUDGETARY REQUIREMENTS. THE ITEM WILL BE PROCURED WITH OMA FUNDS BY THE NICP/SICC AND WILL BE "FREE ISSUED" TO ARMY CUSTOMERS (OVER $3000)'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '9', 8, 'BASE SPARES:  STOCKS OWNED BY NRC'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'A', 9, 'PA PRINCIPAL ITEMS:  AIRCRAFT'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'B', 10, 'PA PRINCIPAL ITEMS:  MODIFICATION OF AIRCRAFT'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'C', 11, 'PA PRINCIPAL ITEMS:  AIRCRAFT SUPPORT EQUIPMENT AND FACILITIES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'D', 12, 'PA PRINCIPAL ITEMS:  ANTI-BALLISTIC MISSILE SYSTEM (SAFEGUARD)'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'E', 13, 'PA PRINCIPAL ITEMS:  OTHER MISSILES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'F', 14, 'PA PRINCIPAL ITEMS:  MODIFICATION OF MISSILES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'G', 15, 'PA PRINCIPAL ITEMS:  OTHER MISSILES SUPPORT EQUIPMENT AND FACILITIES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'H', 16, 'PA PRINCIPAL ITEMS:  TRACKED COMBAT VEHICLES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'I', 17, 'FROM PURGED MDR'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'J', 18, 'PA PRINCIPAL ITEMS:  WEAPONS & OTHER COMBAT VEHICLES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'K', 19, 'PA PRINCIPAL ITEMS:  AMMUNITION'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'L', 20, 'PA PRINCIPAL ITEMS:  TACTICAL VEHICLES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'M', 21, 'PA PRINCIPAL ITEMS:  COMMERCIAL VEHICLES'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'N', 22, 'PA PRINCIPAL ITEMS:  COMMUNICATIONS AND ELECTRONICS EQUIPMENT (SAFEGUARD)'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'P', 23, 'PA PRINCIPAL ITEMS:  COMMUNICATIONS AND ELECTRONICS EQUIPMENT (EXCEPT SAFEGUARD)'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'Q', 24, 'PA PRINCIPAL ITEMS:  OTHER SUPPORT EQUIPMENT'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'R', 25, 'MISSLE (SAFEGUARD) SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'S', 26, 'AIRCRAFT SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'T', 27, 'OTHER MISSILES (EXCEPT SAFEGUARD) SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'U', 28, 'WEAPONS & OTHER COMBAT VEHICLE SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'V', 29, 'TRACKED COMBAT VEHICLES SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'W', 30, 'TACTICAL & SUPPORT VEHICLE SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'X', 31, 'COMMUNICATIONS & ELECTRONICS EQUIPMENT SPARES & OTHER REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'Y', 32, 'OTHER SUPPORT EQUIPMENT SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, 'Z', 33, 'SPECIAL WEAPONS & CHEMICAL SPARES & REPAIR PARTS'); 
    INSERT INTO gb_pfsawh_code_ref (cat_code, item_code, code_sort_order, item_text) VALUES (1020, '99', 34, 'Unknown'); 

        
    COMMIT;
    
    UPDATE gb_pfsawh_code_ref a
    SET    (status, updt_by, lst_updt) = 
        (    
        SELECT mc2.status, mc2.updt_by, mc2.lst_updt 
        FROM   mat_cat_2_ref@pfsawh.lidbdev mc2 
        WHERE  mc2.mat_cat_cd_2 = a.item_code
        )
    WHERE cat_code = 1020; 
    
    COMMIT; 
    
END;    

SELECT cat_code, item_code, item_text, 
    status, fn_pfsawh_get_code_ref_desc(1020, status) AS status_desc, 
    updt_by, lst_updt, code_sort_order   
FROM gb_pfsawh_code_ref 
WHERE cat_code = 1020 
ORDER BY code_sort_order;

SELECT df.cat_code, 
    df.code_name, 
    COUNT(cd.item_code) AS CNT, 
    MIN(cd.item_code)   AS MIN, 
    MAX(cd.item_code)   AS MAX,  
    MAX(LENGTH(cd.item_code))   AS LEN_CODE,  
    MAX(LENGTH(cd.item_text))   AS LEN_TEXT 
    --, cd.* 
FROM	gb_pfsawh_code_definition_ref df, 
       gb_pfsawh_code_ref cd 
WHERE  df.cat_code = cd.cat_code  (+)
GROUP BY df.cat_code, 
    df.code_name 
ORDER BY df.cat_code; 
